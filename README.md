# Abstract Computer System Toolchain and Emulator Project

## Overview

This project involves the development of tools in the compilation chain and an emulator for an abstract computer system. The tools include an assembler for the abstract computer system and an architecture-independent linker. The project also includes an emulator to execute the assembled and linked programs.

## Features

- **Lexical Analysis**: Uses Flex and Bison for parsing input files.
- **Assembler**: Converts assembly language code into machine code for the abstract computer system.
- **Linker**: Combines multiple object files into a single executable, resolving symbols and addresses.
- **Emulator**: Executes the machine code on a simulated abstract computer system.

## Project Structure

The project is divided into three main tasks:

1. **Assembler**
2. **Linker**
3. **Emulator**


### Assembler

The assembler translates assembly language code into machine code. It supports various directives and instructions as specified in the project requirements.

#### Directives

| `.global` | `.extern` | `.section` | `.word`   |
|-----------|-----------|------------|------------|
| `.skip`   | `.ascii`  | `.equ`     | `.end`    |

#### Instructions

| `halt` | `int` | `iret` |
|-------|-------|-------|
| `call` | `ret` | `jmp` |
| `beq` | `bne` | `bgt` |
| `push` | `pop` | `xchg` |
| `add` | `sub` | `mul` |
| `div` | `not` | `and` |
| `or` | `xor` | `shl` |
| `shr` | `ld` | `st` |
| `csrrd` | `csrwr` | |

### Linker

The linker combines object files generated by the assembler into a single executable. It handles symbol resolution, relocation, and section placement.

- **Options**:
  - `-o <output_file>`
  - `-place=<section>@<address>`
  - `-hex`
  - `-relocatable`

### Emulator

The emulator simulates the execution of the machine code on an abstract computer system. It supports the following features:

- **Processor**: 32-bit, two-address, Von-Neumann architecture.
- **Memory**: 4 GB address space, little-endian byte order.
- **Registers**: 16 general-purpose registers, including `pc` and `sp`.
- **Interrupts**: Single interrupt handler, with support for timer and terminal interrupts.
- **Peripherals**:
  - **Terminal**: Input/output device with memory-mapped registers.
  - **Timer**: Generates periodic interrupts.

### Lexical Analysis

The project uses Flex and Bison for lexical analysis and parsing of input files. These tools help in generating the lexer and parser needed for the assembler and linker.

- **Flex**: A tool for generating scanners, programs that recognize lexical patterns in text.
- **Bison**: A parser generator that converts a grammar description for an LALR(1) context-free grammar into a C program to parse that grammar.


## Development Environment

The project is developed under a Linux operating system on an amd64 architecture using C/C++. The recommended development environment is a VMware virtual machine with all necessary tools pre-installed.

## Building and Running

To build and run the project, use the provided Makefile with the following targets:

- `make`: Compile the assembler, linker, and emulator.
- `make clean`: Clean the build directory.

### Example Commands

```sh
./asembler -o handler.o handler.s
./asembler -o main.o main.s
./linker -hex -place=my_code_main@0x40000000 -place=my_code_handler@0xC0000000 -o program.hex handler.o main.o
./emulator program.hex
